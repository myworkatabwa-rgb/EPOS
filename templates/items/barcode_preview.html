<!DOCTYPE html>
<html>
<head>
    <title>Print Barcodes</title>

    {% load static %}

    <link rel="stylesheet" href="{% static 'css/barcode.css' %}">

    <style>
        body{
            margin:0;
            padding:10px;
            background:white;
        }
    </style>

</head>
<body>

<div id="print-area" class="barcode-container">

{% for product in items %}
{% if settings.show_company %}
<div class="store">
    {{ store_name }}
</div>
{% endif %}

{% if settings.show_price %}
<div class="price">
    Rs {{ product.price }}
</div>
{% endif %}

{% if settings.show_barcode %}
<div class="barcode">
    <svg class="barcode-svg"
         data-sku="{{ product.sku }}"></svg>
</div>
{% endif %}

{% if settings.show_name %}
<div class="name">
    {{ product.name }}
</div>
{% endif %}

{% if settings.show_mfg %}
<div class="mfg">
    MFG: {{ settings.mfg_date }}
</div>
{% endif %}

{% if settings.show_best %}
<div class="best">
    Best Before: {{ settings.best_date }}
</div>
{% endif %}


<div class="label">

    <div class="store">
        {{ store_name }}
    </div>

    <div class="price">
        Rs {{ product.price }}
    </div>

    <div class="barcode">
        <svg class="barcode-svg"
             data-sku="{{ product.sku }}"></svg>
    </div>

    <div class="name">
        {{ product.name }}
    </div>

    <div class="sku">
        {{ product.sku }}
    </div>

</div>

{% endfor %}

</div>


<script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>

<script>

document.addEventListener("DOMContentLoaded", function(){

    document.querySelectorAll(".barcode-svg").forEach(function(el){

        JsBarcode(el, el.dataset.sku, {
            format: "CODE128",
            width: 2,
            height: 60,
            displayValue: true,
            fontSize: 14,
            margin: 0
        });

    });

    // Auto print
    setTimeout(function(){
        window.print();
    }, 300);

});

// Auto close after print
window.onafterprint = function(){
    window.close();
};

</script>


</body>
</html>
